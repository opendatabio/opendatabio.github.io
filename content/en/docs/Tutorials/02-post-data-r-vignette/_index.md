---
title: "Import data with R"
linkTitle: "Import data with R"
weight: 3
author: "A. Vicentini & A. Chalom"
date: 2021-09-09
description: >
  Import data using the OpenDataBio R client
---

{{% pageinfo color="warning" %}}
The [Opendatabio-R package](https://github.com/opendatabio/opendatabio-r) was created to allow users to interact with an OpenDataBio server, to both obtain (GET) data or to import (POST) data into the database. This tutorial is a basic example of how to import data.
{{% /pageinfo %}}

## Set up the connection

1. Set up the connection to the OpenDataBio server using the `odb_config()` function. The most important parameters for
this function are `base_url`, which should point to the API url for your OpenDataBio server, and
`token`, which is the access token used to authenticate your user.
1. The `token` is mandatory to import data.
1. Your token is avaliable in your profile in the web interface

```r
library(opendatabio)
base_url="http://localhost:8080/api"
token ="GZ1iXcmRvIFQ"
#create a config object
cfg = odb_config(base_url=base_url, token = token)
#test connection
odb_test(cfg)
```

## Importing data (POST API)

> Check the [API Quick-Reference](/docs/api/quick-reference) for a full list of POST endpoints and link to details.

### OpenDataBio-R import functions

All import functions have the same signature: the first argument is a `data.frame` with data to be imported, and the second parameter is a configuration object generated by `odb_config`.

When writing an import request, check the [POST API docs](/docs/api/post-data) in order to understand which columns can be declared in the `data.frame`.

All import functions return a `job id`, which can be used to check if the job is still running, if it ended with success or if it encountered an error. This job id can be used in the functions `odb_get_jobs()`, `odb_get_affected_ids()` and `odb_get_log()`, to find details about the job, which (if any) were the IDs of the successfully imported objects, and the full log of the job. You may also see the log in your user jobs list in the web interface.

{{< alert color="warning" title="Attention">}}
**Order is Important** - correctly importing data may depend on already registered records. For example, importing an Individual with a Taxon identity requires the taxon name registered in the database, so you would first validate your taxon list using the [GET API](/docs/api/get-data) and then import the records for the Individuals.
{{< /alert >}}

## Working with dates and incomplete dates

For Individuals, Vouchers and Identifications you may use incomplete dates.

The date format used in OpenDataBio is YYY-MM-DD (year - month - day), so a valid entry would be `2018-05-28`.

Particularly in historical data, the exact day (or month) may not be known, so you can substitute this fields with NA: '1979-05-NA' means "an unknown day, in May 1979", and '1979-NA-NA' means "unknown day and month, 1979". You may not add a date for which you have only the day, but can if you have only the month if is actually meaningful in some way.
